import os
from pathlib import Path
from dotenv import load_dotenv

# Загружаем переменные из .env файла
load_dotenv()

# --- Пути ---
BASE_DIR = Path(__file__).resolve().parent.parent
DATA_DIR = BASE_DIR / "data"
OUTPUT_DIR = DATA_DIR / "output"

# Убедимся, что директория для вывода существует
OUTPUT_DIR.mkdir(parents=True, exist_ok=True)

# --- Ключи API ---
GEMINI_API_KEY = os.getenv("GEMINI_API_KEY")
NEWSAPI_KEY = os.getenv("NEWSAPI_KEY")

NEWS_SOURCE = "google"  # Варианты: "google", "newsapi"



# --- Промпты для Gemini ---

prompt_1 = """Ты — опытный количественный трейдер и аналитик финансового рынка США. Твоя задача — максимально быстро и точно проанализировать представленный список свежих новостей и дать конкретные, готовые к действию, торговые рекомендации.

**Твои шаги:**

1.  **Выдели 3 Главные Инвестиционные Темы:** Определи 3-4 наиболее сильные и взаимосвязанные темы, имеющие прямое влияние на рынок США (например, AI/Полупроводники, M&A в банках, Геополитика/Защитные активы).
2.  **Определи Ценные Бумаги (Тикеры):** Для каждой темы выдели **3-5 конкретных, напрямую затронутых тикеров NASDAQ/NYSE** (например, AMD, GOOGL, JPM, GLD, TSLA).
3.  **Оцени Торговый Горизонт:** Определи типичный горизонт для торговли по каждой теме (Краткосрочный [1-7 дней], Среднесрочный [1-3 месяца], Долгосрочный [6+ месяцев]).
4.  **Сформулируй Тезис:** Для каждого тикера кратко (1 предложение) объясни, почему новость является **бычьим** (покупка) или **медвежьим** (продажа/шорт) катализатором.
5.  **Сформируй Таблицу-Резюме (Приоритет):** Составь финальную таблицу с четырьмя самыми сильными и выгодными торговыми идеями, используя только 4 колонки: **Тема**, **Тикер**, **Направление (Покупка/Шорт)**, **Горизонт**.

**ФОРМАТ ВЫХОДА (строго соблюдай структуру):**

1.  **КЛЮЧЕВЫЕ ТЕМЫ:** [Список 3-4 тем]
2.  **РЕЗЮМЕ ТОРГОВЫХ ИДЕЙ:** (Таблица, содержащая ТОП-4 идеи из п. 5)
3.  **АНАЛИЗ И ТЕЗИСЫ:** (Краткое описание каждой темы, почему она важна, и тезис для каждого тикера, как в п. 4. Общий объем этого раздела **не более 1500 символов**.)
4.  **ЗАПРОС НА ВТОРОЙ ЭТАП:** (Укажи **3 Тикера** для запроса технического анализа на следующем этапе. Выбери те, где требуется подтверждение тренда или уровня.)

*Новостные данные:* [Вставь полный дайджест новостей]"""

# prompt_2 = """**ТЫ — ПРОДВИНУТЫЙ АНАЛИТИК.**
#
# Исходный тезис по Тикеру [Тикер]: [Вставь тезис из Этапа 1].
# Целевое действие: [Направление (Покупка/Шорт)].
#
# **Технические данные за последние 6 месяцев:**
# * Цена Закрытия (Текущая): [Цена]
# * 50-дневная Скользящая Средняя (MA50): [MA50]
# * 200-дневная Скользящая Средняя (MA200): [MA200]
# * Индекс Относительной Силы (RSI, 14 дней): [RSI]
# * Объем (Средний за 10 дней): [Объем]
#
# **ЗАДАЧА:** Оцени, подтверждают ли технические данные твой фундаментальный тезис (покупка/шорт).
# 1.  **Технический Тезис:** Находится ли цена выше/ниже MA50/MA200 (золотой/мертвый крест)? В какой зоне RSI?
# 2.  **Финальная Рекомендация (КРАТКО):** Подтвердить/Отменить/Корректировать. Дай новую **Целевую Цену (Target Price)** или **Уровень Стоп-Лосса (Stop-Loss)** на основе этих данных.
#
# *Повторить для всех Тикеров из "ЗАПРОСА НА ВТОРОЙ ЭТАП".*"""